<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
		<style>
img {
	border: 1px solid #cfd9e3;
	margin-bottom: 16px;
}

textarea {
	margin-bottom: 16px;
	font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
	font-size: .875em;
	white-space: pre;
	overflow-wrap: normal;
	overflow-x: scroll;
}

pre {
	font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
	font-size: .875em;
	margin-left: 24px;
	padding-left: 16px;
	border-left: 2px solid #cfd9e3;
}

blockquote {
	font-style: italic;
	margin-left: 24px;
	padding-left: 16px;
	border-left: 2px solid #0d6efd;
}

.note {
	border: 2px solid #cfd9e3;
	margin: auto 36px;
	padding: 8px 16px;
	margin-bottom: 16px;
}
		</style>
	</head>
	<body>
		<div class="container my-3">
			<h1>Tutorial: WordPress Walker with Bootstrap 5</h1>
			<p>If you're learning to build custom themes in WordPress, you'll probably want to create a navigation menu that the user can edit.  However, it can be a little complicated to get a WordPress custom menu to output with the right classes for Bootstrap.  This tutorial will go over that process step by step to get you up and running with a custom navigation menu the user can control in the WordPress admin panel, but that comes out as properly formatted Bootstrap 5.</p>
			<p>Short on time and just want the final code with comments?  Head over to <a href="https://github.com/esbwebdesign/demo-walker-bootstrap-5">this repository</a> on my GitHub and download the contents of the folder <em>demo_walker_theme</em>.</p>
			<h3>Prerequisites</h3>
			<ul>
				<li>Some HTML</li>
				<li>General concept of Bootstrap</li>
				<li>Working WordPress environment (if you need help, <a href="https://www.makeuseof.com/install-wordpress-locally-on-windows/">this tutorial is great</a>)</li>
			</ul>
			<h2>Initial Setup</h2>
			<p>Create a basic WordPress theme.  To do this, create a new folder in <code>\wp-content\themes</code>.  Create three files inside it: <code>index.php</code>, <code>style.css</code>, and <code>functions.php</code>.</p>
			<p>First, we'll create the HTML template that we'll want to turn into a dynamic navigation bar.</p>
			<p>Go to the WordPress admin page and activate your theme under Appearance > Themes.</p></p>
			<p>Next, let's create the HTML template that we'll hollow out to create our dynamic navbar.  Copy and paste this text into your <code>index.php</code> file.</p>
<textarea readonly class="w-100" rows="10">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
					<div class="collapse navbar-collapse" id="navbarSupportedContent">
						<ul class="navbar-nav ms-auto">
							<li class="nav-item">
								<a class="nav-link active" aria-current="page" href="#">Home</a>
							</li>
							<li class="nav-item ms-lg-5">
								<a class="nav-link" href="http://www.google.com">Google</a>
							</li>
							<li class="nav-item dropdown ms-lg-5">
								<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">W3 Schools</a>
								<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
									<li><a class="dropdown-item" href="https://www.w3schools.com/html/">HTML</a></li>
									<ul>
										<li class="list-unstyled"><a class="dropdown-item" href="https://www.w3schools.com/html/html5_semantic_elements.asp">Semantic HTML</a></li>
									</ul>
									<li><a class="dropdown-item" href="https://www.w3schools.com/php/">PHP</a></li>
								</ul>
							</li>
							<li class="nav-item ms-lg-5">
								<li><a class="nav-link" href="<?php echo site_url('/about-us'); ?>">About Us</a></li>
							</li>
						</ul>
					</div>
			</div>
		</nav>
		<script type='text/javascript' src='//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' id='bootstrap-5-js'></script>
	</body>
</html>
</textarea>
			<p>Now, if you go to any page on your site, you should see something like this (when you've expanded the dropdown menu):</p>
			<div class="text-center"><img src="images/screenshot-1.png" class="w-75" alt="Image of the navigation bar at the current stage"></div>
			<p>Next, we'll add support for a WordPress-managed navigation bar. Add this code to your <code>functions.php</code> file:</p>
<textarea readonly class="w-100" rows="7">
<?php
function theme_features() {
	register_nav_menu('header-menu', 'Header Menu');
}

add_action('after_setup_theme', 'theme_features');
?>
</textarea>
			<p>This creates a menu and makes it available with this theme.  Go to the WordPress admin panel, and under Appearance make sure you see Menus.  If you don't see it, you either need to refresh, or you've missed something in your <code>functions.php</code> file.</p>
			<p class="note">Before we continue, if you're having trouble, you can download the code as it stands at this stage of the tutorial.  It's in the folder <em>demo_walker_theme_hc</em> (for 'hard coded') at <a href="https://github.com/esbwebdesign/demo-walker-bootstrap-5">this repository</a> on my GitHub.</p>
			<p>Now, in the WordPress admin panel, create a page.  I made a dummy "About Us" page, but you can make whatever you want.  For this demo, our navigation bar will have a Home Page link and an About Us link, and the rest of the navigation menu options will be to external sites, so you don't need to create pages for everything in our navigation bar.</p>
			<p>In the WordPress admin panel, under Appearance > Menus, create your menu.  In this demo, we'll use the Home Page (which is there by default), the About Us page, and some custom links.  Make sure to drag some of your links under others.  We need at least two levels for this demo.  For example, we have HTML under W3 Schools, and then Semantic HTML under HTML.</p>
			<div class="text-center"><img src="images/screenshot-2.png" class="w-75" alt="Image of the menu management panel in WordPress"></div>
			<p>Give your menu a name and save it.</p>
			<p>At the top of the page, under the word <strong>Menus</strong>, click on "Manage Locations."  Select your menu and assign it to the Header Menu location.  Hit <strong>Save Changes.</strong></p>
			<div class="text-center"><img src="images/screenshot-3.png" class="w-75" alt="Image of the menu selection panel in WordPress"></div>
			<h2>Using a WordPress Menu</h2>
			<p>So far, we've set everything up, but our <code>index.php</code> file isn't actually using our WordPress menu yet; it's still using our hard-coded menu.  Let's change that!</p>
			<p>We need to leave some of the outer 'shell' of the navbar, so we're going to be getting rid of everything inside the <code>div</code> with the class of <code>collapse navbar-collapse</code>.  I would suggest copying it and pasting it into another document, because we're going to need to reference it a lot.</p>
			<p>So, to recap, when we're done, we want WordPress to output this code:</p>
<textarea readonly class="w-100" rows="10">
<div class="collapse navbar-collapse" id="navbarSupportedContent">
	<ul class="navbar-nav ms-auto">
		<li class="nav-item">
			<a class="nav-link active" aria-current="page" href="#">Home</a>
		</li>
		<li class="nav-item ms-lg-5">
			<a class="nav-link" href="http://www.google.com">Google</a>
		</li>
		<li class="nav-item dropdown ms-lg-5">
			<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">W3 Schools</a>
			<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
				<li><a class="dropdown-item" href="https://www.w3schools.com/html/">HTML</a></li>
				<ul>
					<li class="list-unstyled"><a class="dropdown-item" href="https://www.w3schools.com/html/html5_semantic_elements.asp">Semantic HTML</a></li>
				</ul>
				<li><a class="dropdown-item" href="https://www.w3schools.com/php/">PHP</a></li>
			</ul>
		</li>
		<li class="nav-item ms-lg-5">
			<li><a class="nav-link" href="<?php echo site_url('/about-us'); ?>">About Us</a></li>
		</li>
	</ul>
</div>
</textarea>
			<p>And our current HTML will be:</p>
<textarea readonly class="w-100" rows="10">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
					<?php
					?>
			</div>
		</nav>
<p>	
</p>
		<script type='text/javascript' src='//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' id='bootstrap-5-js'></script>
	</body>
</html>
</textarea>
			<p>Note the PHP tags below the closing <code>button</code> tag.  From here out, when referring to the code we're putting in <code>index.php</code>, I'll just be pasting the parts that go inside the PHP tags.</p>
			<h2>Adding a WordPress Menu to Index.php</h2>
			<p>To start out with, let's just add our menu with the WordPress <code>wp_nav_menu</code> function:</p>
<pre>wp_nav_menu(array(
	'theme_location' => 'header-menu'
));</pre>
			<p>This simply calls the menu created in <code>functions.php</code>.  The value for the <code>theme_location</code> key needs to be the first value from the <code>register_nav_menu</code> function in your <code>functions.php</code> file.  So, in my case, I'll use <code>'header-menu'</code>.</p>
			<div class="note">
				<p>You can name your menu whatever you want; you just have to make sure that you use the same name when you call your menu.</p>
				<p>For example, if your <code>functions.php</code> file contains the line:</p>
					<pre>register_nav_menu('pizza-menu', 'Header Menu');</pre>
				<p>Then your <code>index.php</code> file will need to contain:</p>
<pre>wp_nav_menu(array(
	'theme_location' => 'pizza-menu'
));</pre>
			</div>
			<p>When you refresh the page, you should see an unordered list, based on your menu bar, which should look something like this:</p>
			<div class="text-center"><img src="images/screenshot-4.png" class="w-75" alt="Image of an unordered list of link in the menu bar"></div>
			<p>At this point, WordPress is sending your menu to the screen, but not in a terribly useful way.  Let's change that.</p>
			<h3>Adding Some Class(es)</h3>
			<p>First, we're going to do what we can with <code>wp_nav_menu</code>.  WordPress has a full list of parameters that we can play with for this function <a href="https://developer.wordpress.org/reference/functions/wp_nav_menu/">here</a>, and I'd encourage you to look over it.  But for now, here's the ones we're interested in:</p>
			<table class="table">
				<thead class="table-light">
					<tr>
						<th width="33%">Parameter</th>
						<th width="67%">Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td width="33%" ><code>container</code></td>
						<td width="67%">This controls whether to wrap the navigation menu inside any HTML tags, and if so, what tag to use.  This will control the outermost layer of the menu.</td>
					</tr>
					<tr>
						<td width="33%" ><code>container-class</code></td>
						<td width="67%">This controls whether to add a class to the container that wraps the entire navigation menu.</td>
					</tr>
					<tr>
						<td width="33%" ><code>container-class</code></td>
						<td width="67%">This controls whether to add an ID to the container that wraps the entire navigation menu.</td>
					</tr>
					<tr>
						<td width="33%" ><code>items_wrap</code></td>
						<td width="67%">Determines how to print out the items inside the navigation bar.  This one is a little confusing, and we'll come back to it.</td>
					</tr>
				</tbody>
			</table>
			<p>Let's start working on what we need to apply here.  Look at the section of HTML you removed earlier.  The topmost line is:</p>
			<pre>&lt;div class="collapse navbar-collapse" id="navbarSupportedContent"&gt;</pre>
			<p>So, with that in mind, the first few parameters are pretty easy.  We'll add parameters like this (blue lines are added code):</p>
<pre>wp_nav_menu(array(
	'theme_location' => 'header-menu',
	<span class="text-primary">'container' => 'div',
	'container_class' => 'collapse navbar-collapse',
	'container_id' => 'navbarSupportedContent'</span>
));</pre>
			<p>This means that the navigation menu will be wrapped in a <code>div</code> with a class of <code>collapse navbar-collapse</code> and an ID of <code>navbarSupportedContent</code>.</p>
			<h4>Items_Wrap</h4>
			<p>Earlier, I said that we'd come back to <code>items_wrap</code>.  Time to do that now.  So, the <a href="https://developer.wordpress.org/reference/functions/wp_nav_menu/">official documentation</a> says:</p>
			<blockquote>How the list items should be wrapped. Uses printf() format with numbered placeholders. Default is a ul with an id and class.</blockquote>
			<p>This is not terribly enlightening if you're learning this for the first time, but to make a long story short, <code>items_wrap</code> has three placeholders available (<a href="https://wordpress.stackexchange.com/questions/19245/any-docs-for-wp-nav-menus-items-wrap-argument">more info here</a>):</p>
			<ul>
				<li><code>%1$s</code>, for the built-in IDs that WordPress generates for menu items</li>
				<li><code>%2$s</code>, for the built-in classes that WordPress generates for menu items</li>
				<li><code>%3$s</code>, for the actual list item (e.g. the li tag)</li>
			</ul>
			<p>Because we're using Bootstrap, we're just going to be using the third placeholder, so our parameter will look like this:</p>
			<pre>'items_wrap' => '&lt;ul class="navbar-nav ms-auto"&gt;%3$s</ul>'</pre>
			<p>Add this below the <code>container_id</code> parameter.  <strong>Common Error:</strong> Remember, you  need a comma between each of the parameters, so when you add this parameter, you need to also add a comma after <code>'container_id' => 'navbarSupportedContent'</code>.</p>
			<p>If you've followed along to this point, your page should look something like this:</p>
			<div class="text-center"><img src="images/screenshot-5.png" class="w-75" alt="Image of the navigation bar with links squished together but on the right side"></div>
			<p>The navigation elements are on the right side of the screen, but they aren't formatted correctly.  To fix this, we're going to use a walker.</p>
			<p>As a recap, before we continue, your code should currently look like this:</p>
			<div class="row">
				<div class="col-12 col-md-6">
					<p><em>Code for </em><code>index.php</code></p>
<textarea readonly class="w-100" rows="5">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
					<?php
					wp_nav_menu(array(
						'theme_location' => 'header-menu',
						'container' => 'div',
						'container_class' => 'collapse navbar-collapse',
						'container_id' => 'navbarSupportedContent',
						'items_wrap' => '<ul class="navbar-nav ms-auto">%3$s</ul>'
					));
					?>
			</div>
		</nav>
<p>
</p>
		<script type='text/javascript' src='//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' id='bootstrap-5-js'></script>
	</body>
</html>
</textarea>
				</div>
				<div class="col-12 col-md-6">
					<p><em>Code for </em><code>functions.php</code></p>
<textarea readonly class="w-100" rows="5">
<?php
function theme_features() {
	register_nav_menu('header-menu', 'Header Menu');
}

add_action('after_setup_theme', 'theme_features');
?>
</textarea>
				</div>
			</div>
			<h2>Creating a Walker</h2>
			<p>In WordPress, a walker is a special tool that helps handle items that are in a hierarchy.  In this case, our navigation bar has a hierarchy, with "Home", "Google, "W3 Schools", and "About Us" on one level, "HTML" and "PHP" down one level below "W3 Schools", and "Semantic HTML" down one level below "HTML" and two below "W3 Schools".</p>
			<p>In order to get the Bootstrap classes we need, we'll need to output different classes depending on where a particular item is in this hierarchy, and we need a walker to do that.  Let's jump over to <code>functions.php</code>.  Add the code:</p>
<pre>class bootstrap_walker extends Walker_Nav_Menu {
}
</pre>
			<p>And in your <code>index.php</code> file, let's add one more parameter to <code>wp_nav_menu</code>:</p>
			<pre>'walker' => new bootstrap_walker()</pre>
			<p class="note">You can use any name instead of <code>bootstrap_walker</code>.  Just make sure you use the same name in <code>functions.php</code> and <code>index.php</code>.</p>
			<h3>Walker Concepts</h3>
			<p>Think of a walker as a subway line.  It has a certain number of stops on a predetermined path, and at every stop, it will do something.</p>
			<p>The subway line is our hierarchy of links.  Every link in the hierarchy is a stop on that line, which is called a <strong>node</strong>.  Every time the subway line makes a stop, we can have it do something, using the code in our <code>functions.php</code> file.</p>
			<p>You can find the official documentation <a href="https://developer.wordpress.org/reference/classes/walker_nav_menu/">here</a>, but basically, <code>walker_nav_menu</code> has four built-in functions you can use to modify it.  You can think of these as instructions the subway driver has to follow at all stops.</p>
			<table class="table">
				<thead class="table-light">
					<tr>
						<th width="33%">Function</th>
						<th width="67%">Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td width="33%" ><code>start_el</code></td>
						<td width="67%"><p>This controls how to output each item (in this case, each <code>li</code> in the navigation menu).  By default, this will open with an <code>li</code> tag, with an ID for each menu item and a bunch of WordPress-generated classes</p>
						<p><strong>Example:</strong><br>
						<code>&lt;li id="menu-item-14" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14"&gt;</code></p></td>
					</tr>
					<tr>
						<td width="33%" ><code>end_el</code></td>
						<td width="67%"><p>This controls how to close each item.  By default, this will just be a closing <code>li</code> tag.</p>
						<p><strong>Example:</strong><br>
						<code>&lt;/li&gt;</code></p></td></td>
					</tr>
					<tr>
						<td width="33%" ><code>start_lvl</code></td>
						<td width="67%"><p>This controls how to wrap each level <strong>after the top level</strong>.  So, in our case, not the level that contains "Home" and "Google", but the level that contains "HTML" and "PHP" or the level that contains "Semantic HTML".  By default, this will open with a <code>ul</code> tag, and a WordPress-generated classes</p>
						<p><strong>Example:</strong><br>
						<code>&lt;ul class="sub-menu"&gt;</code></p></td>
					</tr>
					<tr>
						<td width="33%" ><code>end_lvl</code></td>
						<td width="67%"><p>This controls how to close the wrap for each level after the top level.  By default, this will just be a closing <code>ul</code> tag.</p>
						<p><strong>Example:</strong><br>
						<code>&lt;/ul&gt;</code></p></td>
					</tr>
				</tbody>
			</table>
			<p>In addition, each node (each 'stop' on the subway line) has a bunch of properties of its own.  You can think of these as attributes of the subway station, like its name, its location, and so on.  Conceptually, what we want to do is at every stop, check these attributes and do something based on them.</p>
			<p>For example, we're going to need to give particular classes to menu items that have children below them in the hierarchy.</p>
			<p>The problem is, there are a BUNCH of these attributes, and it's not that obvious what we have to work with.</p>
			<p>In order to figure this out, there's a handy function called <code>var_dump</code>, which will spit out a bunch of information about an object.  If you run this code from your <code>functions.php</code> file:</p>
<pre>class bootstrap_walker extends Walker_Nav_Menu {
	function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
		$output .= var_dump($item);
	}
}</pre>
			<p>You'll get all the information about <strong>each</strong> menu item.  This is a bit of a pain, so I've gone over the important information for each of the functions that's a part of <code>Walker_Nav_Menu</code> and indented it for easy reading.</p>
<textarea readonly class="w-100" rows="10">
start_el/end_el
	$item
	object(WP_Post)#926 (40) { 
		["ID"]=> int(47) 
		["post_author"]=> string(1) "1" 
		["post_date"]=> string(19) "2022-08-18 07:45:15" 
		["post_date_gmt"]=> string(19) "2022-08-18 07:44:50" 
		["post_content"]=> string(1) " " 
		["post_title"]=> string(0) "" 
		["post_excerpt"]=> string(0) "" 
		["post_status"]=> string(7) "publish" 
		["comment_status"]=> string(6) "closed" 
		["ping_status"]=> string(6) "closed" 
		["post_password"]=> string(0) "" 
		["post_name"]=> string(2) "47" 
		["to_ping"]=> string(0) "" 
		["pinged"]=> string(0) "" 
		["post_modified"]=> string(19) "2022-08-18 07:45:15" 
		["post_modified_gmt"]=> string(19) "2022-08-18 07:45:15" 
		["post_content_filtered"]=> string(0) "" 
		["post_parent"]=> int(0) ["guid"]=> string(35) "http://localhost/esbwebdesign/?p=47" 
		["menu_order"]=> int(1) 
		["post_type"]=> string(13) "nav_menu_item" 
		["post_mime_type"]=> string(0) "" 
		["comment_count"]=> string(1) "0" 
		["filter"]=> string(3) "raw" 
		["db_id"]=> int(47) 
		["menu_item_parent"]=> string(1) "0" 
		["object_id"]=> string(2) "33" 
		["object"]=> string(4) "page" 
		["type"]=> string(9) "post_type" 
		["type_label"]=> string(4) "Page" 
		["url"]=> string(30) "http://localhost/esbwebdesign/" 
		["title"]=> string(4) "Home" 
		["target"]=> string(0) "" 
		["attr_title"]=> string(0) "" 
		["description"]=> string(0) "" 
		["classes"]=> array(9) { 
			[0]=> string(0) "" 
			[1]=> string(9) "menu-item" 
			[2]=> string(24) "menu-item-type-post_type" 
			[3]=> string(21) "menu-item-object-page" 
			[4]=> string(14) "menu-item-home" 
			[5]=> string(17) "current-menu-item" 
			[6]=> string(9) "page_item" 
			[7]=> string(12) "page-item-33" 
			[8]=> string(17) "current_page_item" 
		} 
		["xfn"]=> string(0) "" 
		["current"]=> bool(true) 
		["current_item_ancestor"]=> bool(false) 
		["current_item_parent"]=> bool(false) 
	}

	$args
	object(stdClass)#912 (18) {
		["menu"]=> object(WP_Term)#915 (10) {
			["term_id"]=> int(11) 
			["name"]=> string(11) "Header Menu" 
			["slug"]=> string(11) "header-menu" 
			["term_group"]=> int(0) 
			["term_taxonomy_id"]=> int(11) 
			["taxonomy"]=> string(8) "nav_menu" 
			["description"]=> string(0) "" 
			["parent"]=> int(0) 
			["count"]=> int(7) 
			["filter"]=> string(3) "raw" 
		} 
		["container"]=> string(3) "div" 
		["container_class"]=> string(24) "collapse navbar-collapse" 
		["container_id"]=> string(22) "navbarSupportedContent" 
		["container_aria_label"]=> string(0) "" 
		["menu_class"]=> string(4) "menu" 
		["menu_id"]=> string(0) "" 
		["echo"]=> bool(true) 
		["fallback_cb"]=> string(12) "wp_page_menu" 
		["before"]=> string(0) "" 
		["after"]=> string(0) "" 
		["link_before"]=> string(0) "" 
		["link_after"]=> string(0) "" 
		["items_wrap"]=> string(44) "%3$s" 
		["item_spacing"]=> string(8) "preserve" 
		["depth"]=> int(0) 
		["walker"]=> object(top_menu_walker)#910 (4) { 
			["tree_type"]=> array(3) { 
				[0]=> string(9) "post_type" 
				[1]=> string(8) "taxonomy" 
				[2]=> string(6) "custom"
			}
			["db_fields"]=> array(2) { 
				["parent"]=> string(16) "menu_item_parent" 
				["id"]=> string(5) "db_id" 
			} 
			["max_pages"]=> int(1) 
			["has_children"]=> bool(false) 
		}
		["theme_location"]=> string(11) "header-menu" 
	}
	
start_lvl/end_lvl
	$args
		object(stdClass)#809 (18) {
			["menu"]=> object(WP_Term)#832 (10) { 
				["term_id"]=> int(3) 
				["name"]=> string(9) "My Header" 
				["slug"]=> string(9) "my-header" 
				["term_group"]=> int(0) 
				["term_taxonomy_id"]=> int(3) 
				["taxonomy"]=> string(8) "nav_menu" 
				["description"]=> string(0) "" 
				["parent"]=> int(0) 
				["count"]=> int(7) 
				["filter"]=> string(3) "raw" 
			} 
			["container"]=> string(3) "div" 
			["container_class"]=> string(24) "collapse navbar-collapse" 
			["container_id"]=> string(22) "navbarSupportedContent" 
			["container_aria_label"]=> string(0) "" 
			["menu_class"]=> string(4) "menu" 
			["menu_id"]=> string(0) "" 
			["echo"]=> bool(true) 
			["fallback_cb"]=> string(12) "wp_page_menu" 
			["before"]=> string(0) "" 
			["after"]=> string(0) "" 
			["link_before"]=> string(0) "" 
			["link_after"]=> string(0) "" 
			["items_wrap"]=> string(40) "%3$s" 
			["item_spacing"]=> string(8) "preserve" 
			["depth"]=> int(0) 
			["walker"]=> object(bootstrap_walker)#844 (4) { 
				["tree_type"]=> array(3) { 
					[0]=> string(9) "post_type" 
					[1]=> string(8) "taxonomy" 
					[2]=> string(6) "custom"
				} 
				["db_fields"]=> array(2) { 
					["parent"]=> string(16) "menu_item_parent" 
					["id"]=> string(5) "db_id"
				} 
				["max_pages"]=> int(1) 
				["has_children"]=> bool(true) 
			} 
		["theme_location"]=> string(11) "header-menu"
	}
</textarea>
			<p>What the heck is this mess?</p>
			<p>Let's do an example.  Add this code to your <code>functions.php</code> file.</p>
<pre>class bootstrap_walker extends Walker_Nav_Menu {
	function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
		$output .= '&lt;li&gt;' . 'PH: ' . $args->walker->has_children;
	}
}</pre>
			<p>Let's walk through this step-by-step:</p>
			<ol><li>Use the function <code>start_el</code>, which will walk through every menu item</li>
			<li>Take the current output variable and add (<code>.=</code>) an <code>&lt;li&gt;</code> tag...</li>
			<li>Add some placeholder text (PH: ) so that you can see what's going on...</li>
			<li>Go into the <code>$args</code> variable of the current menu item, then into the <code>walker</code> key, and then into the <code>has_children</code> key and show that value</li></ol>
			<p>You should see something like this:</p>
			<div class="text-center"><img src="images/screenshot-6.png" class="w-75" alt="Image of the navigation bar, PH for each menu item, accompanied by a 1 for items that have subordinate menu items"></div>
			<p>It looks a little funny, but you can see the placeholder text 'PH: ' for every item, but then any item that has children also gets a 1 (which also means true).</p>
			<p>With this in mind, we now have the tools to target any property of the menu items and sub-menus.  Let's start applying some classes.</p>
			<h3>A Logic Puzzle</h3>
			<p>Looking at our HTML, most <code>li</code> tags and <code>a</code> tags get classes, many of them more than one.  Some tags also need to get an ID.  Most list items need the class <code>nav-item</code> and most anchor tags need the class <code>nav-link</code>, so let's create an array of classes for list items and anchor tags, and add those entries in by default.</p>
			<h4>Inside start_el (Part 1)</h4>
<pre>class bootstrap_walker extends Walker_Nav_Menu {
	function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
		$li_class[] = 'nav-item';
		$a_class[] = 'nav-link';
	}
}</pre>
			<p>In addition, let's make the starting anchor tag.</p>
			<pre>$link_tag = '&lt;a class="' . implode(' ', $a_class) . '" href="' . $item-&gt;url . '"&gt;';</pre>
			<p>This will have the opening <code>a</code> tag, then a list of all classes from the <code>$a_class</code> array, separated by a space. (The <code>implode</code> function turns an array into a delimited string.  The first argument says what should separate the items in that array when you turn it into a string.  In this case, we want it to be  a space.)  Then, we start the href attribute, and finally, we'll ask it for the URL of the current menu item.</p>
			<p>Finally, let's output each list item to the screen:</p>
			<pre>$output .= '&lt;li class="' . implode(' ', $li_class) . '"&gt;' . $link_tag . $item-&gt;title . '&lt;/a&gt;';</pre>
			<p>This will output an <code>li</code> tag, then a list of classes from the <code>$li_class</code> array, and then the anchor tag we just created.  We don't need to close the <code>li</code> tag, because <code>Walker_Nav_Menu</code> does that by default.</p>
			<p>Your navbar should now look like this:</p>
			<div class="text-center"><img src="images/screenshot-7.png" class="w-75" alt="Image of the navigation bar showing the correct text for each menu item and styled like Bootstrap menu items, but with an unordered list of sub-menu items below it"></div>
			<p>All the links should now be clickable too.</p>
			<p>Let's start going through our original navbar code and see what classes we need to apply.  The first entry had the code:</p>
<pre>&lt;li class="nav-item"&gt;
	&lt;a class="nav-link active" aria-current="page" href="#"&gt;Home&lt;/a&gt;
&lt;/li&gt;</pre>
			<p>The <code>li</code> is fine, but we want whatever link is active to get the <code>active</code> class, as well as to get some screen-reader support.</p>
			<p>In addition, suppose we have a sub-page that's active.  We'd want the parent of that sub-page to be active, right?  Let's add another page called "Our Team" and add a link to it to our menu, like this:</p>
			<div class="text-center"><img src="images/screenshot-8.png" class="w-75" alt="Image of the WordPress menu structure menu, showing a menu item linked to the 'Our Team' page nested below the 'About Us' page"></div>
			<p>If the user was on the "Our Team" page, we'd want to set the "About Us" menu link to active, since one  of its children is active.  Fortunately, this is pretty easy.  Before the line that sets the <code>$link_tag</code> variable, add the code:</p>
<pre>if($item->current || $item->current_item_ancestor) {
	$a_class[] = 'active';
}</pre>
			<p>Or, in English: "If the current item is active, or if it's the ancestor of the current item, then add the class <code>active</code> to the array of classes."  If you refresh and click on the "Our Team" menu item, you should now see this:</p>
			<div class="text-center"><img src="images/screenshot-9.png" class="w-75" alt="Image of the navigation bar with the menu items 'About Us' and 'Our Team' set to a darker color, indicating they are currently active links"></div>
			<p>Finally, let's add the screen reader support.  We only want to add <code>aria-current="page"</code> to the current item, not to its parent.  Let's update this function to:</p>

<textarea readonly class="w-100" rows="10">function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
	$li_class[] = 'nav-item';
	$a_class[] = 'nav-link';
	$aria = '';
	
	if($item->current || $item->current_item_ancestor) {
		$a_class[] = 'active';
		if($item->current) {
			$aria = ' aria-current="page"';
		}
	}
	
	$link_tag = '<a class="' . implode(' ', $a_class) . $aria . '" href="' . $item->url . '">';
	
	$output .= '<li class="' . implode(' ', $li_class) . '">' . $link_tag . $item->title . '</a>';
}</textarea>
			<p>We need to add a placeholder variable (<code>$aria = '';</code>) so we don't get an 'Undefined variable' error (since we'll only get a value for <code>$aria</code> if our conditions are met).</p>
			<p>Next, we want to add some extra spacing between top-level items.  Let's add this code:</p>
<pre>if($item->menu_order != 1 && !$item->menu_item_parent) {
	$li_class[] = 'ms-lg-5';
}</pre>
			<p>This says that if this isn't the first item in the menu (since we only want to add space <strong>between</strong> items, and if the item has no parents, then add a Bootstrap class to add a margin to the beginning of the item (the left, in a ltr layout).</p>
			<p>Time to style our dropdown menus.  Let's look at our original code:</p>
<pre>&lt;li class="nav-item dropdown ms-lg-5"&gt;
	&lt;a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"&gt;W3 Schools&lt;/a&gt;</pre>
			<p>There's a lot going on here.</p>
			<ul><li>We need to add the <code>dropdown</code> class to our <code>li</code> tag</li>
			<li>We need to add the <code>dropdown-toggle</code> code to our <code>a</code> tag</li>
			<li>We need to make sure there's just a placeholder location as the <code>href</code> value</li>
			<li>We need to apply some other attributes to the <code>a</code> tag</li></ul>
			<p>First, we'll add another placeholder variable to our <code>start_el</code> function:</p>
			<pre>$a_dropdown = '';</pre>
			<p>Next, we'll add this code:</p>
<pre>if($args->walker->has_children && $depth == 0) {
	$li_class[] = 'dropdown';
	$a_class[] = 'dropdown-toggle';
	$item->url = '#';
	$a_dropdown = ' id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"';
}</pre>
			<p>In other words:</p>
			<ul><li>Add <code>'dropdown'</code> to our array of list item classes</li>
			<li>Add <code>'dropdown-toggle'</code> to our array of anchor classes</li>
			<li>Override the current URL of this item, and set it to <code>'#'</code></li>
			<li>Add the extra attributes we'll need for our anchor tag</li></ul>
			<p>Finally, we'll update our <code>$link_tag</code> value</p>
			<pre>$link_tag = '&lt;a class="' . implode(' ', $a_class) . $a_dropdown . $aria . '" href="' . $item-&gt;url . '"&gt;';</pre>
			<p>If you refresh, you should see this:</p>
			<div class="text-center"><img src="images/screenshot-10.png" class="w-75" alt="Image of the navigation bar with triangle dropdown togglers by items that have children.  The children are still visible as unordered lists below their parent menu items."></div>
			<p>The toggles don't do anything yet, but that's okay--we'll need another function to help us with that.  We'll be coming back to <code>start_el</code>, but let's take a quick detour to get this dropdown list working properly.</p>
			<p>Before we move on, here's our current code:</p>
			<div class="row">
				<div class="col-12 col-md-6">
					<p><em>Code for </em><code>index.php</code></p>
<textarea readonly class="w-100" rows="5">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
					<?php
					wp_nav_menu(array(
						'theme_location' => 'header-menu',
						'container' => 'div',
						'container_class' => 'collapse navbar-collapse',
						'container_id' => 'navbarSupportedContent',
						'items_wrap' => '<ul class="navbar-nav ms-auto">%3$s</ul>',
						'walker' => new bootstrap_walker()
					));
					?>
			</div>
		</nav>
		<script type='text/javascript' src='//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' id='bootstrap-5-js'></script>
	</body>
</html>
</textarea>
				</div>
				<div class="col-12 col-md-6">
					<p><em>Code for </em><code>functions.php</code></p>
<textarea readonly class="w-100" rows="5">
<?php

function theme_features() {
	register_nav_menu('header-menu', 'Header Menu');
}

add_action('after_setup_theme', 'theme_features');

class bootstrap_walker extends Walker_Nav_Menu {
		function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
			$li_class[] = 'nav-item';
			$a_class[] = 'nav-link';
			$aria = '';
			$a_dropdown = '';
			
			if($item->current || $item->current_item_ancestor) {
				$a_class[] = 'active';
				if($item->current) {
					$aria = ' aria-current="page"';
				}
			}
			
			if($item->menu_order != 1 && !$item->menu_item_parent) {
				$li_class[] = 'ms-lg-5';
			}
			
			if($args->walker->has_children && $depth == 0) {
				$li_class[] = 'dropdown';
				$a_class[] = 'dropdown-toggle';
				$item->url = '#';
				$a_dropdown = ' id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"';
			}
			
			$link_tag = '<a class="' . implode(' ', $a_class) . $a_dropdown . $aria . '" href="' . $item->url . '">';
			
			$output .= '<li class="' . implode(' ', $li_class) . '">' . $link_tag . $item->title . '</a>';
		}
}

?>
</textarea>
				</div>
			</div>
			<h4>Inside start_lvl</h4>
			<p>Right now, our dropdowns don't work because the <code>ul</code> inside them don't have the right classes and ID.  Now, our code inside <code>functions.php</code> handles the outermost <code>ul</code>--that was set with the value of <code>items_wrap</code>--but, we need <code>start_lvl</code> to wrap any lower levels.</p>
			<p>Our original code was:</p>
			<pre>&lt;ul class="dropdown-menu" aria-labelledby="navbarDropdown"&gt;</pre>
			<p>So, we want to apply this <em>only</em> to the first <code>ul</code> below our main menu items (since we only want to have to expand the menu once.  To do that, we need to add this code within <code>class top_menu_walker extends Walker_Nav_Menu</code>, but outside our <code>start_el</code> function.</p>
<pre>function start_lvl(&$output, $depth = 0, $args = null) {
	if(!$depth) {
		$output .= '&lt;ul class="dropdown-menu" aria-labelledby="navbarDropdown"&gt;';
	} else {
		$output .= '&lt;ul&gt;';
	}
}</pre>
			<p>This will say that if the depth is equal to 0 (that is, if it's the first <code>ul</code> after the top level), then use <code>&lt;ul class="dropdown-menu" aria-labelledby="navbarDropdown"&gt;</code>; otherwise, just use <code>&lt;ul&gt;</code>.</p>
			<p class="note">We can use <code>!$depth</code> because the first <code>ul</code> after the top has a depth of 0.  In PHP, 0 is a 'falsy' value, meaning it's interpreted as <code>false</code>.  Because of that <code>!$depth</code> is equivalent to <code>$depth == 0</code>.</p>
			<p>Save and refresh, and you should see this (I've expanded one dropdown for convenience):</p>
			<div class="text-center"><img src="images/screenshot-11.png" class="w-75" alt="Image of the navigation bar with dropdowns working as expected.  The W3 Schools dropdown is expanded and shows the top level items behaving as expected, but the lowest level item still styled with an unordered list."></div>
			<p>Now that our dropdown is working, let's go back to <code>start_el</code> and finish up applying classes to list items and links.  Before you go, here's a snapshot of our current code:</p>
			<div class="row">
				<div class="col-12 col-md-6">
					<p><em>Code for </em><code>index.php</code></p>
<textarea readonly class="w-100" rows="5">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
					<?php
					wp_nav_menu(array(
						'theme_location' => 'header-menu',
						'container' => 'div',
						'container_class' => 'collapse navbar-collapse',
						'container_id' => 'navbarSupportedContent',
						'items_wrap' => '<ul class="navbar-nav ms-auto">%3$s</ul>',
						'walker' => new bootstrap_walker()
					));
					?>
			</div>
		</nav>
		<script type='text/javascript' src='//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' id='bootstrap-5-js'></script>
	</body>
</html>
</textarea>
				</div>
				<div class="col-12 col-md-6">
					<p><em>Code for </em><code>functions.php</code></p>
<textarea readonly class="w-100" rows="5">
<?php

function theme_features() {
	register_nav_menu('header-menu', 'Header Menu');
}

add_action('after_setup_theme', 'theme_features');

class bootstrap_walker extends Walker_Nav_Menu {
		function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
			$li_class[] = 'nav-item';
			$a_class[] = 'nav-link';
			$aria = '';
			$a_dropdown = '';
			
			if($item->current || $item->current_item_ancestor) {
				$a_class[] = 'active';
				if($item->current) {
					$aria = ' aria-current="page"';
				}
			}
			
			if($item->menu_order != 1 && !$item->menu_item_parent) {
				$li_class[] = 'ms-lg-5';
			}
			
			if($args->walker->has_children && $depth == 0) {
				$li_class[] = 'dropdown';
				$a_class[] = 'dropdown-toggle';
				$item->url = '#';
				$a_dropdown = ' id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"';
			}
			
			$link_tag = '<a class="' . implode(' ', $a_class) . $a_dropdown . $aria . '" href="' . $item->url . '">';
			
			$output .= '<li class="' . implode(' ', $li_class) . '">' . $link_tag . $item->title . '</a>';
		}
		
		function start_lvl(&$output, $depth = 0, $args = null) {
			if(!$depth) {
				$output .= '<ul class="dropdown-menu" aria-labelledby="navbarDropdown">';
			} else {
				$output .= '<ul>';
			}
		}
}

?>
</textarea>
				</div>
			</div>
			<h4>Inside start_el (Part 2)</h4>
			<p>Let's have a look at our original code from inside the dropdown:</p>
<pre>&lt;li&gt;&lt;a class="dropdown-item" href="https://www.w3schools.com/html/"&gt;HTML&lt;/a&gt;&lt;/li&gt;
&lt;ul&gt;
	&lt;li class="list-unstyled"&gt;&lt;a class="dropdown-item" href="https://www.w3schools.com/html/html5_semantic_elements.asp"&gt;Semantic HTML&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;li&gt;&lt;a class="dropdown-item" href="https://www.w3schools.com/php/"&gt;PHP&lt;/a&gt;&lt;/li&gt;</pre>
			<p>We've got a few things to tidy up:</p>
			<ul><li>All links get the class <code>dropdown-item</code></li>
			<li>The first level of list items in the dropdown menu don't get a class at all</li>
			<li>List items after the first level get the class <code>list-unstyled</code> (to get rid of the bullet you can see next to "Semantic HTML")</li></ul>
			<p>Let's add this code in our <code>start_el</code> function:</p>
<pre>if($item->menu_item_parent) {
	$a_class = ['dropdown-item'];
	if($depth == 1) {
		$li_class = [];
	} else {
		$li_class = ['list-unstyled'];
	}
}</pre>
			<p>In other words:</p>
			<ul><li>If the menu item has a parent, add the class <code>dropdown-item</code> to the array of anchor classes</li>
			<li>If the depth is exactly 1 (e.g. it's the first level within a dropdown), reset <code>$li_class</code> to an empty array</li>
			<li>Otherwise (e.g. if the depth is greater than 1), add the class <code>list-unstyled</code> to the array of list item classes</li></ul>
			<h4>Refactor and Cleanup</h4>
			<p>With the line above, we've successfully implemented a Bootstrap 5 navigation bar, managed through WordPress.  But there's a bit of cleanup we can do.</p>
			<h5>Empty Class Array</h5>
			<p>First, there are some cases where we don't have any classes applied.  Right now, that produces <code>&lt;li class=""&gt;</code>.  That's not exactly wrong, but it's untidy.  Let's clean that up.  We'll put this in our <code>start_el</code> function. This needs to go before the <code>$output =</code> code, but after any code that adds list item classes.</p>
<pre>if(count($li_class)) {
	$class_wrap = [' class="', '"'];
} else {
	$class_wrap = ['', ''];
}</pre>
			<p>Then, we'll update our <code>$output</code> code:</p>
			<pre>$output .= '&lt;li' . $class_wrap[0] . implode(' ', $li_class) . $class_wrap[1]. '&gt;' . $link_tag . $item-&gt;title . '&lt;/a&gt;';</pre>
			<p>In other words, if there are any items in the <code>$li_class</code> array, then create an array with the beginning and end of a class statement.  Otherwise, create an array with two empty strings.  Then, use it to wrap around your classes.</p>
			<p>Now, if you refresh and look at your source code, if there are no classes, you just see <code>&lt;li&gt;</code>.</p>
			<h5>More Readable Code</h5>
			<p>Finally, I like to have my navbar code a bit more readable, with tabs and new lines.</p>
			<h6>Index.php</h6>
			<p>To do this, we'll need to be able to access a variable that tells us our starting tab depth (that is, how deeply the first line of the navbar code should be indented).  Before <code>wp_nav_menu</code>, let's add a variable:
			<pre>$tab_depth = 6;</pre>
			<p>It needs to be before <code>wp_nav_menu</code> because we're going to need to access it inside that function.  On that subject, let's update <code>items_wrap</code> like this:</p>
			<pre>'items_wrap' =&gt; '&lt;ul class="navbar-nav ms-auto"&gt;%3$s' . str_repeat("\t", $tab_depth-2) . '&lt;/ul&gt;',</pre>
			<p>This will add tab indentation to our outermost <code>ul</code>.  Finally, after and outside <code>wp_nav_menu</code>, let's add a new line like this:</p>
			<pre>echo "\r\n";</pre>
			<p>So now, our PHP section in our <code>index.php</code> file should look like this:</p>
<pre>&lt;?php
$tab_depth = 6;
wp_nav_menu(array(
	'theme_location' =&gt; 'header-menu',
	'container' =&gt; 'div',
	'container_class' =&gt; 'collapse navbar-collapse',
	'container_id' =&gt; 'navbarSupportedContent',
	'items_wrap' =&gt; '&lt;ul class="navbar-nav ms-auto"&gt;%3$s' . str_repeat("\t", $tab_depth-2) . '&lt;/ul&gt;',
	'walker' =&gt; new bootstrap_walker(),
	'tab_depth' =&gt; $tab_depth
));
echo "\r\n";
?&gt;</pre>
			<p>This will simply add a new line in our code after the end of the navigation menu.</p>
			<h6>Functions.php - start_el</h6>
			<p>Now, let's go to our <code>functions.php</code> file.  We need to add a new empty variable to our variables section in our <code>start_el</code> function:</p>
			<pre>$code_spacer = '';</pre>
			<p>Next, find the if statement that starts <code>if($item->menu_order != 1 && !$item->menu_item_parent)</code> and change the entire statement to:</p>
<pre>if($item->menu_order != 1) {
	if(!$item->menu_item_parent) {
		$li_class[] = 'ms-lg-5';
	}
} else {
	$code_spacer = "\r\n";
}
$code_spacer .= str_repeat("\t", $args->tab_depth + $depth);</pre>
			<p>In other words:</p>
			<ol><li>If the current menu item isn't the first in the list <strong>and</strong> it has no parents, then add the class <code>ms-lg-5</code> to its list of classes.</li>
			<li>If the current menu item is the first menu item in the list, then set <code>$code_spacer</code> to be a new line.</li>
			<li>After the above, add (append) tab indentation to the item.  Give it the number of tabs equal to the <code>$tab_depth</code> variable, plus its depth within the menu</li></ol>
			<p>Now update <code>$output</code> to:</p>
			<pre>$output .= $code_spacer . '&lt;li' . $class_wrap[0] . implode(' ', $li_class) . $class_wrap[1]. '&gt;' . $link_tag . $item-&gt;title . '&lt;/a&gt;';</pre>
			<h6>Functions.php - start_lvl</h6>
			<p>Update this entire function to the below:</p>
<pre>function start_lvl(&$output, $depth = 0, $args = null) {
	$code_spacer = "\r\n" . str_repeat("\t", $args-&gt;tab_depth + $depth);
	$ul_add = '';
	if(!$depth) {
		$ul_add = ' class="dropdown-menu" aria-labelledby="navbarDropdown"';
	}
	$output .= $code_spacer . '&lt;ul' . $ul_add . '&gt;' . "\r\n";
}</pre>
			<p>In other words:</p>
			<ol><li>Set <code>$code_spacer</code> to contain a new line, and then tab indentation equal to the <code>$tab_depth</code> variable, plus this sub-menu's depth within the current menu.</li>
			<li>Create a variable to contain additional information for the <code>ul</code>.</li>
			<li>If this sub-menu is the topmost submenu (e.g. with a depth of 0), then set <code>$ul_add</code> to contain some additional information</li>
			<li>Set the output (which is a <code>ul</code> that has a sub-menu in it) to have the contents of <code>$code_spacer</code>, then a <code>ul</code> opening tag with the contents of <code>$ul_add</code> inside it (if any), and then another new line.</li></ol>
			<h6>Functins.php - end_lvl</h6>
			<p>Last, we need to add one more function inside <code>Walker_Nav_Menu</code>:</p>
<pre>function end_lvl(&$output, $depth = 0, $args = null) {
	$tab_depth = str_repeat("\t", $args-&gt;tab_depth + $depth);
	$output .= $tab_depth . '&lt;/ul&gt;' . "\r\n" . $tab_depth;
}</pre>
			<p>In other words, set the <code>$tab_depth</code> variable to contain tab indentation equal to the <code>$tab_depth</code> variable, plus this sub-menu's depth within the current menu.  Output the tab indentation, then the closing <code>ul</code> tag, then a new line, and then the same number of tabs.</p>
			<p>With all that done, if you save, refresh, and view the page source, your page code should look like this:</p>
<textarea readonly class="w-100" rows="10">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div id="navbarSupportedContent" class="collapse navbar-collapse"><ul class="navbar-nav ms-auto">
						<li class="nav-item"><a class="nav-link" href="http://localhost/demo_walker/">Home</a></li>
						<li class="nav-item ms-lg-5"><a class="nav-link" href="http://www.google.com">Google</a></li>
						<li class="nav-item ms-lg-5 dropdown"><a class="nav-link dropdown-toggle id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"" href="#">W3 Schools</a>
						<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
							<li><a class="dropdown-item" href="https://www.w3schools.com/html/">HTML</a>
							<ul>
								<li class="list-unstyled"><a class="dropdown-item" href="https://www.w3schools.com/html/html5_semantic_elements.asp">Semantic HTML</a></li>
							</ul>
							</li>
							<li><a class="dropdown-item" href="https://www.w3schools.com/php/">PHP</a></li>
						</ul>
						</li>
						<li class="nav-item ms-lg-5 dropdown"><a class="nav-link active dropdown-toggle id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"" href="#">About Us</a>
						<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
							<li><a class="dropdown-item aria-current="page"" href="http://localhost/demo_walker/our-team/">Our Team</a></li>
						</ul>
						</li>
				</ul></div>
			</div>
		</nav>
		<script type='text/javascript' src='//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js' id='bootstrap-5-js'></script>
	</body>
</html>
</textarea>
			<p>And that's it!  To find the final code (with full comments), head over to <a href="https://github.com/esbwebdesign/demo-walker-bootstrap-5">this repository</a> on my GitHub and download the contents of the folder <em>demo_walker_theme</em>.</p>
		</div>
	</body>
</html>